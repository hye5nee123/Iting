<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.iting.note.mapper.NoteMapper">
	<!-- 전체조회 -->
	<select id="getNoteList" resultType="NoteVO">
		SELECT NOTE_NUM
		       , NOTE_TTL
		       , NOTE_CNTN
		       , RPLY
		       , SENT_DT
		       , REC_DT
		       , CFM_YN_CD
		       , SENT_PS
		       , REC_PS
		FROM NOTE
		ORDER BY NOTE_NUM DESC
	</select>
	
	<!-- 등록 -->
	<insert id="insertNote" parameterType="NoteVO">	
		<selectKey keyProperty="noteNum"
					order="BEFORE"
					resultType="string">
			SELECT 'no' || LPAD(NVL(MAX(SUBSTR(NOTE_NUM, -5)), 0) + 1, 5, '0') AS NOTE_NUM 
			FROM NOTE
		</selectKey>
		INSERT INTO PRBL(NOTE_NUM
						, NOTE_TTL
						, NOTE_CNTN
						, RPLY
						, SENT_DT
						, REC_DT
						, CFM_YN_CD
						, SENT_PS
						, REC_PS)
		VALUES ( 
				  #{noteNum}
				, #{noteTtl}
				, #{noteCntn}
				, #{rply}
			    , #{sentDt}
				, #{recDt}
				, #{cfmYnCd}
				, #{sentPs}
				, #{recPs}
				)
	</insert>
</mapper>