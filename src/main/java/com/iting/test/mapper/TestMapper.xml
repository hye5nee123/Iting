<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.iting.test.mapper.TestMapper">
	<!-- 전체조회 -->
	<select id="getTestList" resultType="TestVO">
		SELECT PRBL_NUM
               , PRBL_CNTN
               , QUES1
               , QUES2
               , QUES3
               , QUES4
               , ANS
               , CTY
               , LT_NUM
		FROM PRBL
		ORDER BY PRBL_NUM DESC
	</select>
	
	<!-- 단건조회 -->
	<select id="getTestInfo" resultType="TestVo">
		SELECT PRBL_NUM
               , PRBL_CNTN
               , QUES1
               , QUES2
               , QUES3
               , QUES4
               , ANS
               , CTY
               , LT_NUM
		FROM PRBL
		WHERE PRBL_NUM = #{prblNum}
	</select>
	
	<!-- 등록 -->
	<insert id="insertTest" parameterType="TestVO">	
		<selectKey keyProperty="prblNum"
					order="BEFORE"
					resultType="string">
			SELECT 'pr' || LPAD(NVL(MAX(SUBSTR(PRBL_NUM, -5)), 0) + 1, 5, '0') AS PRBL_NUM 
			FROM PRBL
		</selectKey>
		INSERT INTO PRBL(PRBL_NUM
		                 , PRBL_CNTN
		                 , QUES1
		                 , QUES2
		                 , QUES3
		                 , QUES4
		                 , ANS
		                 , CTY
		                 , LT_NUM)
		VALUES ( 
				  #{prblNum}
				, #{prblCntn}
				, #{ques1}
				, #{ques2}
			    , #{ques3}
				, #{ques4}
				, #{ans}
				, #{cty}
				, #{ltNum}
				)
	</insert>
	
	<!-- 수정 -->
	<update id="updateTest">
		UPDATE PRBL
		SET PRBL_CNTN = #{prblCntn}
            , QUES1 = #{ques1}
            , QUES2 = #{ques2}
            , QUES3 = #{ques3}
            , QUES4 = #{ques4}
            , ANS = #{ans}
            , CTY = #{cty}
		WHERE PRBL_NUM = #{prblNum}
	</update>
	
	<!-- 삭제 -->
	<delete id="deleteTest">
		DELETE FROM PRBL
		WHERE PRBL_NUM = #{prblNum}
	</delete>
</mapper>