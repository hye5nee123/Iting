<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/admin/layout}">
<head>
<meta charset="UTF-8">
<title>강의승인 페이지</title>
<script th:inline="javascript">
function move(ltNum){
	location.href='/teacher/lecture/info/'+ ltNum
}

</script>

<style>
#asd {
	float: right;
	padding: 12px 40px;
	font-size: 16px;
	border: 0;
	letter-spacing: -1px;
	background: #ff8a00;
	color: #fff;
	border-radius: 5px;
}
</style>
</head>
<body>
	<div id="container" layout:fragment="container">
		<div class="card">
			<h4 class="card-header">
				강의 목록
			</h4>
				<form name="frmSearch" class="input-group" >
                          <span th:object="${LectureVO}" class="input-group-text">
                          <i class="tf-icons bx bx-search" ></i></span>
                          <input type="text" class="form-control" placeholder="제목을 입력해주세요."
                           name="ltTtl" th:value="*{ltTtl}">
                          
                        </form>
				<table class="table">
					<thead>
						<tr>
							<th>강의번호</th>
							<th>강의제목</th>
							<th>강의소개</th>
							<th>시작날짜</th>
							<th>강의난이도</th>
							<th>강의키워드</th>
							<th>강사번호</th>
							<th>승인여부</th>
						</tr>

					</thead>
					<tbody id="endLectureList">
						
					</tbody>
				</table>
				<div id="navs"></div>
			</div>
			
<script th:inline="javascript">

	
	//함수 호출.
	listReq(1);
	
	//controller에서 주소 따옴.
	function listReq(page) {
		fetch("/admin/lecture/endLectureList?page="+page)
		.then(res => res.json())
		.then(res => listRes(res))
	}
	
	function gopage(p){
		//검색 기능 하면 다시 살리기//
		frmSearch.page.value = p;
		frmSearch.submit();
		listReq(p);
	}
	 
	//list 응답.
	function listRes(res) {
		endLectureList.innerHTML = '';
		console.log(res);
		// 목록출력
		for( obj of res.data) {
			endLectureList.innerHTML += makeTr(obj);
		}
		
		//paging 출력
		navs.innerHTML = makePage(res.paging);
	}
	//tr 생성.
	function makeTr(obj) {
		let newTag = `<tr>
			<td>${obj.ltNum}</td>
			<td>${obj.ltTtl}</td>
			<td>${obj.ltIntro}</td>
			<td>${obj.frDt}</td>
			<td>${obj.ltDifCd}</td>
			<td>${obj.ltKeywordCd}</td>
			<td>${obj.lecturerNum}</td>
			<td>${obj.accpYnCd}</td>
		</tr>`
		console.log(newTag);
		return newTag;
	}
		
	function makePage(paging) {
		console.log(paging)

		let tag = `<nav aria-label="...">
		  <ul class="pagination">`;
		
		// 이전 버튼
		if(paging.startPage > 1) {
			tag += `<li class="page-item">
		        <a class="page-link" href="javascript:gopage(${paging.startPage-1})">Previous</a></li>`;
		}
		// 페이지 번호
		for(i=paging.startPage; i <= paging.endPage; i++) {
			tag += `<li class="page-item">
				<a class="page-link" href="javascript:gopage(${i})">${i}</a></li>`;
		}
		// 다음 버튼
		if(paging.endPage <= paging.lastPage) {
			tag += `<li class="page-item">
				<a class="page-link" href="javascript:gopage(${paging.endPage + 1})">Next</a></li>`;
		    tag += `</ul>
		    	</nav>`;
		}
		return tag;
	}
</script>
		</div>
		 <div id="navs">        
            </div>
</body>

</html>